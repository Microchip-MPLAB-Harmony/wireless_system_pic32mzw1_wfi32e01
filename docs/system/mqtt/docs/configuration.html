<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <link rel="shortcut icon" href="../../../favicon.ico" type="image/x-icon"> <link rel="stylesheet" href="../../../assets/css/just-the-docs-default.css"> <script async src="https://www.googletagmanager.com/gtag/js?id=UA-2724382-16"></script> <script> window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'UA-2724382-16'); </script> <script type="text/javascript" src="../../../assets/js/vendor/lunr.min.js"></script> <script type="text/javascript" src="../../../assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.7.1 --> <title>MQTT System Service Configuration | Microchip MPLAB Harmony PIC32MZW1 wireless system services help</title> <meta name="generator" content="Jekyll v3.9.0" /> <meta property="og:title" content="MQTT System Service Configuration" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="Harmony 3 PIC32MZW1/WFI32 wireless system services" /> <meta property="og:description" content="Harmony 3 PIC32MZW1/WFI32 wireless system services" /> <link rel="canonical" href="../../../system/mqtt/docs/configuration.html" /> <meta property="og:url" content="../../../system/mqtt/docs/configuration.html" /> <meta property="og:site_name" content="Microchip MPLAB Harmony PIC32MZW1 wireless system services help" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="MQTT System Service Configuration" /> <script type="application/ld+json"> {"@type":"WebPage","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"../../assets/images/vendor/microchip_mplab_harmony_logo_150_transparent.png"}},"url":"../../../system/mqtt/docs/configuration.html","headline":"MQTT System Service Configuration","description":"Harmony 3 PIC32MZW1/WFI32 wireless system services","@context":"https://schema.org"}</script> <!-- End Jekyll SEO tag --> </head> <body> <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header"> <a href="../../../index.html" class="site-title lh-tight"> <div class="site-logo"></div> </a> <a href="#" id="menu-button" class="site-button"> <svg viewBox="0 0 24 24" class="icon"><use xlink:href="#svg-menu"></use></svg> </a> </div> <nav role="navigation" aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item active"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="../../../index.html" class="nav-list-link">Harmony 3 PIC32MZW1 wireless system services package</a><ul class="nav-list "><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="../../../system/wifi/docs/readme.html" class="nav-list-link">Wi-Fi Service</a><ul class="nav-list"><li class="nav-list-item "> <a href="../../../system/wifi/docs/configuration.html" class="nav-list-link">Wi-Fi System Service Configuration</a> </li><li class="nav-list-item "> <a href="../../../system/wifi/docs/developer_guide.html" class="nav-list-link">Wi-Fi System Service developer guide</a> </li><li class="nav-list-item "> <a href="../../../system/wifi/docs/usage.html" class="nav-list-link">Wi-Fi System Service Usage</a> </li><li class="nav-list-item "> <a href="../../../system/wifi/docs/interface.html" class="nav-list-link">Wi-Fi System Service Interface</a> </li></ul></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="../../../system/wss/docs/readme.html" class="nav-list-link">Web Socket Server System Service</a><ul class="nav-list"><li class="nav-list-item "> <a href="../../../system/wss/docs/developer.html" class="nav-list-link">Web Socket System Service Developer's Guide</a> </li><li class="nav-list-item "> <a href="../../../system/wss/docs/usage.html" class="nav-list-link">Web Socket Server System Service Usage</a> </li><li class="nav-list-item "> <a href="../../../system/wss/docs/interface.html" class="nav-list-link">Web Socket Server System Service Interface</a> </li></ul></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="../../../system/appdebug/docs/readme.html" class="nav-list-link">App Debug Service</a><ul class="nav-list"><li class="nav-list-item "> <a href="../../../system/appdebug/docs/configuration.html" class="nav-list-link">App Debug System Service Configuration</a> </li><li class="nav-list-item "> <a href="../../../system/appdebug/docs/usage.html" class="nav-list-link">App Debug System Service Usage</a> </li><li class="nav-list-item "> <a href="../../../system/appdebug/docs/interface.html" class="nav-list-link">App Debug System Service Interface</a> </li></ul></li><li class="nav-list-item active"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="../../../system/mqtt/docs/readme.html" class="nav-list-link">MQTT Service</a><ul class="nav-list"><li class="nav-list-item active"> <a href="../../../system/mqtt/docs/configuration.html" class="nav-list-link active">MQTT System Service Configuration</a> </li><li class="nav-list-item "> <a href="../../../system/mqtt/docs/usage.html" class="nav-list-link">MQTT System Service Usage</a> </li><li class="nav-list-item "> <a href="../../../system/mqtt/docs/developer.html" class="nav-list-link">MQTT System Service Developer's Guide</a> </li><li class="nav-list-item "> <a href="../../../system/mqtt/docs/interface.html" class="nav-list-link">MQTT System Service Interface</a> </li></ul></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="../../../system/net/docs/readme.html" class="nav-list-link">Net Service</a><ul class="nav-list"><li class="nav-list-item "> <a href="../../../system/net/docs/configuration.html" class="nav-list-link">Net System Service Configuration</a> </li><li class="nav-list-item "> <a href="../../../system/net/docs/developer.html" class="nav-list-link">Net System Service Developer's Guide</a> </li><li class="nav-list-item "> <a href="../../../system/net/docs/usage.html" class="nav-list-link">Net System Service Usage</a> </li><li class="nav-list-item "> <a href="../../../system/net/docs/interface.html" class="nav-list-link">Net System Service Interface</a> </li></ul></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="../../../system/wifiprov/docs/readme.html" class="nav-list-link">Wi-Fi provisioning Service</a><ul class="nav-list"><li class="nav-list-item "> <a href="../../../system/wifiprov/docs/configuration.html" class="nav-list-link">Wi-Fi provisioning System Service Configuration</a> </li><li class="nav-list-item "> <a href="../../../system/wifiprov/docs/developer_guide.html" class="nav-list-link">Wi-Fi provisioning System Service developer guide</a> </li><li class="nav-list-item "> <a href="../../../system/wifiprov/docs/usage.html" class="nav-list-link">Wi-Fi provisioning System Service Usage</a> </li><li class="nav-list-item "> <a href="../../../system/wifiprov/docs/interface.html" class="nav-list-link">Wi-Fi provisioning System Service Interface</a> </li></ul></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="../../../system/ota/docs/readme.html" class="nav-list-link">OTA Service</a><ul class="nav-list"><li class="nav-list-item "> <a href="../../../system/ota/docs/configuration.html" class="nav-list-link">OTA System Service Configuration</a> </li><li class="nav-list-item "> <a href="../../../system/ota/docs/usage.html" class="nav-list-link">OTA System Service Usage</a> </li><li class="nav-list-item "> <a href="../../../system/ota/docs/developer_guide.html" class="nav-list-link">OTA System Developer's guide</a> </li><li class="nav-list-item "> <a href="../../../system/ota/docs/interface.html" class="nav-list-link">OTA System Service Interface</a> </li></ul></li></ul></li><li class="nav-list-item"><a href="../../../release_notes.html" class="nav-list-link">Release notes</a></li><li class="nav-list-item"><a href="../../../mplab_harmony_license.html" class="nav-list-link">License</a></li></ul> </nav> <footer class="site-footer"> This site uses <a href="https://github.com/pmarsceill/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll. </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search Microchip MPLAB Harmony PIC32MZW1 wireless system services help" aria-label="Search Microchip MPLAB Harmony PIC32MZW1 wireless system services help" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> <nav aria-label="Auxiliary" class="aux-nav"> <ul class="aux-nav-list"> <li class="aux-nav-list-item"> <a href="https://support.microchip.com" class="site-button" > Obtain Support from Microchip </a> </li> </ul> </nav> </div> <div id="main-content-wrap" class="main-content-wrap"> <nav aria-label="Breadcrumb" class="breadcrumb-nav"> <ol class="breadcrumb-nav-list"> <li class="breadcrumb-nav-list-item"><a href="../../../index.html">Harmony 3 PIC32MZW1 wireless system services package</a></li> <li class="breadcrumb-nav-list-item"><a href="../../../system/mqtt/docs/readme.html">MQTT Service</a></li> <li class="breadcrumb-nav-list-item"><span>MQTT System Service Configuration</span></li> </ol> </nav> <div id="main-content" class="main-content" role="main"> <h1 id="mqtt-system-service-configuration"> <a href="#mqtt-system-service-configuration" aria-labelledby="mqtt-system-service-configuration" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> MQTT System Service Configuration </h1> <p>The MQTT System Service library should be configured through the MHC. When user selects the MQTT System Service library, all the required dependencies components are added automatically in the MHC configuration.</p> <p>The following figure shows the MHC configuration window for configuring the MQTT System Service and a brief description of various configuration options.</p> <ul> <li>Open the MHC 3</li> <li>Drag the MQTT Service Module into the Active components from the Available components</li> </ul> <div style="text-align: center;" class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>![](/wireless_system_pic32mzw1_wfi32e01/system/mqtt/docs/images/Mqtt_service_MHC.png)
</code></pre></div></div> <ul> <li>Configure the various parameters of Basic Configuration</li> </ul> <p style="text-align: center;"><img src="../../../system/mqtt/docs/images/Mqtt_Basic_Service.png" alt="" /></p> <div class="table-wrapper"><table> <thead> <tr> <th>Parameter Name</th> <th>Default Value</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td>Broker Name</td> <td> </td> <td>Name of the MQTT Broker<br />Note: User should ensure that the Broker is UP and running. In case the connection timesout often, the User can modify the value of SYS_MQTT_PERIOIDC_TIMEOUT as per his requirement.</td> </tr> <tr> <td>Server Port</td> <td> </td> <td>Port number of the MQTT Broker at which the MQTT Client should connect</td> </tr> <tr> <td>Enable TLS</td> <td>FALSE</td> <td>If TRUE, the MQTT connection should use TLS while connecting to the broker. If FALSE, the MQTT connection should not use TLS.<br />Note: In case the TLS is enabled, the User needs to update the component ‘Presentation Layer’ with the CA Certificate format, location, name, and size. Other parameters can be updated as per the User’s requirements.</td> </tr> <tr> <td>Enable SNI</td> <td>FALSE</td> <td>Server Name Indication ff TRUE, enables a client device to specify the domain name it is trying to reach in the first step of the TLS handshake.<br />Note: In case the SNI is enabled, the Broker Name is taken as the Domain Name.</td> </tr> <tr> <td>Enable ALPN</td> <td>FALSE</td> <td>Application-Layer Protocol Negotiation (ALPN) is a TLS extension that allows the application layer to negotiate which protocol should be performed over a secure connection in a manner that avoids additional round trips and which is independent of the application-layer protocols</td> </tr> <tr> <td>Client Id</td> <td> </td> <td>MQTT Client Id should be unique for the Broker. If left empty, the Id will be generated randomly</td> </tr> <tr> <td>Network Interface</td> <td> </td> <td>Network Interface - Wifi or Ethernet on which the MQTT Client should run. On choosing Ethernet, the MHC will add EthMAC, MIIM, and LAM8740 Components. The User needs to attach the EthMAC to the NetConfig (in System Component Window) via the MAC parameter in Instance 1</td> </tr> </tbody> </table></div> <p><img src="../../../system/mqtt/docs/images/Net_service_netconfig.png" alt="" /></p> <ul> <li>Configure the various parameters of Presentation Layer if TLS enabled</li> </ul> <p style="text-align: center;"><img src="../../../system/mqtt/docs/images/presentation_layer.png" alt="" /></p> <ul> <li>Configure the various parameters of ‘Advanced Configuration’ of the MQTT Service</li> </ul> <p style="text-align: center;"><img src="../../../system/mqtt/docs/images/Mqtt_Adv_Service.png" alt="" /></p> <div class="table-wrapper"><table> <thead> <tr> <th>Parameter Name</th> <th>Default Value</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td>Enable Auto Reconnect</td> <td>TRUE</td> <td>If TRUE, the MQTT Service will auto reconnect to the Broker if connection is broken. If FALSE, the customer application needs to take care of triggering the connection process again.</td> </tr> <tr> <td>Enable Clean Session</td> <td>TRUE</td> <td>If TRUE, the MQTT Client shall tell the Broker that the session is clean; else, it will let the Broker know that the session is a continuation of the previous session. Also, if “clean session” is disabled, it is valid only within a single boot session in the Client (i.e. reconnecting before the next power-on reset) and not across boots</td> </tr> <tr> <td>KeepAlive Interval</td> <td>60 sec</td> <td>If no data flows over an open connection for a certain KeepAliveInterval then the client will generate a PINGREQ and expect to receive a PINGRESP from the broker. This message exchange confirms that the connection is open and working</td> </tr> <tr> <td>Username/ Password</td> <td>Disabled</td> <td>In case the connection to Broker needs a Username and Password</td> </tr> <tr> <td>Last Will and testament</td> <td>Disabled</td> <td>LWT Configuration has the following parameters – <br /> 1. Topic, <br /> 2. QoS, <br /> 3. Retain, and <br /> 4. Message <br />This ‘Message’ will be sent on the ‘Topic’ whenever the Broker finds that there is an ungraceful disconnection with the Client.</td> </tr> </tbody> </table></div> <ul> <li>Configure the remaining parameters</li> </ul> <p style="text-align: center;"><img src="../../../system/mqtt/docs/images/Mqtt_Remaining_Service.png" alt="" /></p> <div class="table-wrapper"><table> <thead> <tr> <th>Parameter Name</th> <th>Default Value</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td>Subscription Topic</td> <td>Disabled</td> <td>Subscription configuration has 2 Parameters – <br /> 1. Topic and <br /> 2. Qos. (0 (Atmost Once), <br /> 1 (Atleast Once),<br /> 2 (Exactly Once))<br /> The User can configure these parameters to subscribe to a Topic to receive messages.</td> </tr> <tr> <td>Publish to Topic</td> <td>Disabled</td> <td>Publishing a message to Topic has 3 Parameters – <br /> 1. Topic and <br /> 2. Qos ( 0 (Atmost Once), 1 (Atleast Once), 2 (Exactly Once))<br /> 3. Retain: If the Broker should retain the message<br /> The User can configure these parameters to and use them along with the message to send it on a particular Topic.</td> </tr> <tr> <td>Enable CLI Commands</td> <td>Enabled</td> <td>Enabling this flag compiles in the CLI commands related to Mqtt Service. The user can use these CLI commands to connect/ disconnect, subscribe/ unsusbscribe, publish messages onto a topic.</td> </tr> <tr> <td>Enable Debug Logs</td> <td>Disabled</td> <td>Enabling this flag compiles in debug logs and user can enable them at runtime. The user can use the following CLI commands to enable/ disable levels and flows for the MQTT service:<br /> 1. sysmqtt debug level <value> <br /> 2. sysmqtt debug flow <value> <br />Note: In case the user enables debug logs, user needs to manually add the 'App Debug Service' component from Wireless-&gt; System Service-&gt; App Debug Service.</value></value></td> </tr> </tbody> </table></div> <p>To use the device certificates stored in <a href="https://www.microchip.com/wwwproducts/en/ATECC608A-TNGTLS">ATECC608A-TNGTLS</a>, enable the “Trust&amp;Go client certificate” option under the net service configurations. Make sure that you enable TLS in the MQTT configuration to use the client certificate during the TLS handshake.</p> <p><img src="../../../system/mqtt/docs/images/TNGTLS_ClientCert.png" alt="" /></p> <p>All of the required files are automatically added into the MPLAB X IDE project by the MHC when the MQTT Service is selected for use.</p> <hr> <footer> <p class="text-small text-grey-dk-000 mb-0"><img src='https://raw.githubusercontent.com/wiki/Microchip-MPLAB-Harmony/Microchip-MPLAB-Harmony.github.io/images/microchip_logo.png' /><br />Copyright &copy; 2020 Microchip Technology.</p> <!-- <p class="text-small text-grey-dk-000 mb-0"><img src='../../../assets/images/vendor/microchip_logo.png' /><br /> Copyright &copy; 2022 Microchip Technology.</p> --> </footer> </div> </div> <div class="search-overlay"></div> </div> </body> </html>
